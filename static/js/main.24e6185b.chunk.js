(this["webpackJsonpreact-template"]=this["webpackJsonpreact-template"]||[]).push([[0],{112:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return B})),n.d(t,"a",(function(){return M})),n.d(t,"d",(function(){return z})),n.d(t,"e",(function(){return P}));n(116);var r=n(14),a=n(26),i=n(29),c=n(2),o=n.n(c),s=n(7),u=n(0),l=n.n(u),d=n(99),f=n(73),p=n(5),b=n(35),h=(n(82),n(211)),m=n(49),v=n(50),g=n(4),j=l.a.createContext(null),x=new Map,y=new Map,O=new Map,k=new Map,w=function(){var t=Object(s.a)(o.a.mark((function t(n,r){var a,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getAccountInfo(r);case 2:if(null!==(a=t.sent)){t.next=5;break}throw new Error("Failed to find mint account");case 5:return i=e.from(a.data),t.abrupt("return",P(i));case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),S=function(t,n){if(n.data.length>0){var r=e.from(n.data),a=z(r);return{pubkey:t,account:Object(i.a)({},n),info:a}}},A=new Map,B={emitter:new h.a,query:function(){var e=Object(s.a)(o.a.mark((function e(t,n,r){var a,i,c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="string"===typeof n?new p.d(n):n,i=a.toBase58(),!(c=y.get(i))){e.next=5;break}return e.abrupt("return",c);case 5:if(!(s=x.get(i))){e.next=8;break}return e.abrupt("return",s);case 8:return s=t.getAccountInfo(a).then((function(e){if(!e)throw new Error("Account not found");return B.add(a,e,r)})),x.set(i,s),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),add:function(e,t,n,r){var a="string"===typeof e?e:null===e||void 0===e?void 0:e.toBase58(),i=n||A.get(a);if(!i)throw new Error("Deserializer needs to be registered or passed as a parameter");B.registerParser(e,i),x.delete(a);var c=i(a,t);if(c){void 0===r?r=!0:r instanceof Function&&(r=r(c));var o=!y.has(a);return y.set(a,c),B.emitter.raiseCacheUpdated(a,o,i,r),c}},get:function(e){var t;return t="string"!==typeof e?e.toBase58():e,y.get(t)},delete:function(e){var t;return t="string"!==typeof e?e.toBase58():e,!!y.get(t)&&(y.delete(t),B.emitter.raiseCacheDeleted(t),!0)},byParser:function(e){var t,n=[],r=Object(a.a)(A.keys());try{for(r.s();!(t=r.n()).done;){var i=t.value;A.get(i)===e&&n.push(i)}}catch(c){r.e(c)}finally{r.f()}return n},registerParser:function(e,t){if(e){var n="string"===typeof e?e:null===e||void 0===e?void 0:e.toBase58();A.set(n,t)}return e},queryMint:function(){var e=Object(s.a)(o.a.mark((function e(t,n){var r,a,i,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="string"===typeof n?new p.d(n):n,a=r.toBase58(),!(i=k.get(a))){e.next=5;break}return e.abrupt("return",i);case 5:if(!(c=O.get(a))){e.next=8;break}return e.abrupt("return",c);case 8:return c=w(t,r).then((function(e){return O.delete(a),k.set(a,e),e})),O.set(a,c),e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getMint:function(e){var t;return t="string"!==typeof e?e.toBase58():e,k.get(t)},addMint:function(e,t){var n=P(t.data),r=e.toBase58();return k.set(r,n),n}};var C=function(){var e=Object(d.useConnection)(),t=Object(f.b)().publicKey,n=Object(u.useState)(),a=Object(r.a)(n,2),i=a[0],c=a[1],l=Object(u.useCallback)((function(e){if(t){var n=function(e,t){if(t){var n=new p.d(e);return{pubkey:e,account:t,info:{address:n,mint:m.h,owner:n,amount:new b.f(t.lamports),delegate:null,delegatedAmount:new b.f(0),isInitialized:!0,isFrozen:!1,isNative:!0,rentExemptReserve:null,closeAuthority:null}}}}(t.toBase58(),e);if(void 0!==n){var r=t.toBase58();B.registerParser(r,S),y.set(r,n),B.emitter.raiseCacheUpdated(r,!1,S,!0)}}}),[t]);return Object(u.useEffect)((function(){var n=0,r=function(e){e&&(l(e),c(e))};return Object(s.a)(o.a.mark((function a(){var i;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e&&t){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,a.next=5,e.getAccountInfo(t);case 5:i=a.sent,r(i),a.next=12;break;case 9:return a.prev=9,a.t0=a.catch(2),a.abrupt("return");case 12:n=e.onAccountChange(t,r);case 13:case"end":return a.stop()}}),a,null,[[2,9]])})))(),function(){n&&e.removeAccountChangeListener(n)}}),[c,t,e,l]),{nativeAccount:i}},E=new Set,T=function(){var e=Object(s.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return E.add(n.toBase58()),e.next=5,t.getTokenAccountsByOwner(n,{programId:Object(v.a)().token});case 5:e.sent.value.forEach((function(e){B.add(e.pubkey.toBase58(),e.account,S)}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function M(e){var t=e.children,n=void 0===t?null:t,a=Object(d.useConnection)(),i=Object(f.b)().publicKey,c=Object(u.useState)([]),o=Object(r.a)(c,2),s=o[0],l=o[1],h=Object(u.useState)([]),m=Object(r.a)(h,2),x=m[0],y=m[1],O=C().nativeAccount,k=null===i||void 0===i?void 0:i.toBase58(),w=Object(u.useCallback)((function(){return B.byParser(S).map((function(e){return B.get(e)})).filter((function(e){return e&&e.info.owner.toBase58()===k})).map((function(e){return e}))}),[k]);return Object(u.useEffect)((function(){var e=w().filter((function(e){return void 0!==e}));y(e)}),[O,s,w]),Object(u.useEffect)((function(){var e=[];return B.emitter.onCache((function(e){if(e.isNew&&e.isActive){var t=e.id,n=e.parser;a.onAccountChange(new p.d(t),(function(e){B.add(t,e,n)}))}})),function(){e.forEach((function(e){return a.removeAccountChangeListener(e)}))}}),[a]),Object(u.useEffect)((function(){if(a&&i){T(a,i).then((function(){l(w())}));var e=a.onProgramAccountChange(Object(v.a)().token,(function(e){var t=e.accountId;if(e.accountInfo.data.length===b.a.span){var n=z(e.accountInfo.data);E.has(n.owner.toBase58())&&(B.add(t,e.accountInfo,S),l(w()))}}),"singleGossip");return function(){a.removeProgramAccountChangeListener(e)}}l([])}),[a,i,w]),Object(g.jsx)(j.Provider,{value:{userAccounts:x,nativeAccount:O},children:n})}var z=function(e){var t=b.a.decode(e);return t.mint=new p.d(t.mint),t.owner=new p.d(t.owner),t.amount=b.f.fromBuffer(t.amount),0===t.delegateOption?(t.delegate=null,t.delegatedAmount=new b.f(0)):(t.delegate=new p.d(t.delegate),t.delegatedAmount=b.f.fromBuffer(t.delegatedAmount)),t.isInitialized=0!==t.state,t.isFrozen=2===t.state,1===t.isNativeOption?(t.rentExemptReserve=b.f.fromBuffer(t.isNative),t.isNative=!0):(t.rentExemptReserve=null,t.isNative=!1),0===t.closeAuthorityOption?t.closeAuthority=null:t.closeAuthority=new p.d(t.closeAuthority),t},P=function(e){if(e.length!==b.b.span)throw new Error("Not a valid Mint");var t=b.b.decode(e);return 0===t.mintAuthorityOption?t.mintAuthority=null:t.mintAuthority=new p.d(t.mintAuthority),t.supply=b.f.fromBuffer(t.supply),t.isInitialized=0!==t.isInitialized,0===t.freezeAuthorityOption?t.freezeAuthority=null:t.freezeAuthority=new p.d(t.freezeAuthority),t}}).call(this,n(16).Buffer)},160:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return z}));n(25);var r,a,i=n(2),c=n.n(i),o=n(7),s=n(19),u=n(10),l=n(5),d=n(50),f=n(55),p=n(8),b="metadata",h="edition";!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.MetadataV1=4]="MetadataV1",e[e.EditionV1=1]="EditionV1",e[e.MasterEditionV1=2]="MasterEditionV1",e[e.MasterEditionV2=6]="MasterEditionV2",e[e.EditionMarker=7]="EditionMarker"}(r||(r={})),function(e){e.Audio="audio",e.Video="video",e.Image="image",e.VR="vr",e.HTML="html"}(a||(a={}));var m=function e(t){Object(u.a)(this,e),this.key=void 0,this.supply=void 0,this.maxSupply=void 0,this.printingMint=void 0,this.oneTimePrintingAuthorizationMint=void 0,this.key=r.MasterEditionV1,this.supply=t.supply,this.maxSupply=t.maxSupply,this.printingMint=t.printingMint,this.oneTimePrintingAuthorizationMint=t.oneTimePrintingAuthorizationMint},v=function e(t){Object(u.a)(this,e),this.key=void 0,this.supply=void 0,this.maxSupply=void 0,this.key=r.MasterEditionV2,this.supply=t.supply,this.maxSupply=t.maxSupply},g=function(){function e(t){Object(u.a)(this,e),this.key=void 0,this.ledger=void 0,this.key=r.EditionMarker,this.ledger=t.ledger}return Object(s.a)(e,[{key:"editionTaken",value:function(e){var t=e%248,n=Math.floor(t/8);if(n>30)throw Error("bad index for edition");var r=7-t%8,a=Math.pow(2,r);return 0!=(this.ledger[n]&a)}}]),e}(),j=function e(t){Object(u.a)(this,e),this.key=void 0,this.parent=void 0,this.edition=void 0,this.key=r.EditionV1,this.parent=t.parent,this.edition=t.edition},x=function e(t){Object(u.a)(this,e),this.address=void 0,this.verified=void 0,this.share=void 0,this.address=t.address,this.verified=t.verified,this.share=t.share},y=function e(t){Object(u.a)(this,e),this.name=void 0,this.symbol=void 0,this.uri=void 0,this.sellerFeeBasisPoints=void 0,this.creators=void 0,this.name=t.name,this.symbol=t.symbol,this.uri=t.uri,this.sellerFeeBasisPoints=t.sellerFeeBasisPoints,this.creators=t.creators},O=function(){function t(e){var n;Object(u.a)(this,t),this.key=void 0,this.updateAuthority=void 0,this.mint=void 0,this.data=void 0,this.primarySaleHappened=void 0,this.isMutable=void 0,this.editionNonce=void 0,this.masterEdition=void 0,this.edition=void 0,this.key=r.MetadataV1,this.updateAuthority=e.updateAuthority,this.mint=e.mint,this.data=e.data,this.primarySaleHappened=e.primarySaleHappened,this.isMutable=e.isMutable,this.editionNonce=null!==(n=e.editionNonce)&&void 0!==n?n:null}return Object(s.a)(t,[{key:"init",value:function(){var t=Object(o.a)(c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Object(p.h)(Object(d.a)().metadata),null===this.editionNonce){t.next=7;break}return t.next=4,l.d.createProgramAddress([e.from(b),n.toBuffer(),Object(p.h)(this.mint).toBuffer(),new Uint8Array([this.editionNonce||0])],n);case 4:this.edition=t.sent.toBase58(),t.next=10;break;case 7:return t.next=9,T(this.mint);case 9:this.edition=t.sent;case 10:this.masterEdition=this.edition;case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),k=function e(t){Object(u.a)(this,e),this.instruction=0,this.data=void 0,this.isMutable=void 0,this.data=t.data,this.isMutable=t.isMutable},w=function e(t){Object(u.a)(this,e),this.instruction=1,this.data=void 0,this.updateAuthority=void 0,this.primarySaleHappened=void 0,this.data=t.data?t.data:null,this.updateAuthority=t.updateAuthority?t.updateAuthority:null,this.primarySaleHappened=t.primarySaleHappened},S=function e(t){Object(u.a)(this,e),this.instruction=10,this.maxSupply=void 0,this.maxSupply=t.maxSupply},A=function e(t){Object(u.a)(this,e),this.instruction=9,this.supply=void 0,this.supply=t.supply},B=new Map([[k,{kind:"struct",fields:[["instruction","u8"],["data",y],["isMutable","u8"]]}],[w,{kind:"struct",fields:[["instruction","u8"],["data",{kind:"option",type:y}],["updateAuthority",{kind:"option",type:"pubkeyAsString"}],["primarySaleHappened",{kind:"option",type:"u8"}]]}],[S,{kind:"struct",fields:[["instruction","u8"],["maxSupply",{kind:"option",type:"u64"}]]}],[A,{kind:"struct",fields:[["instruction","u8"],["supply","u64"]]}],[m,{kind:"struct",fields:[["key","u8"],["supply","u64"],["maxSupply",{kind:"option",type:"u64"}],["printingMint","pubkeyAsString"],["oneTimePrintingAuthorizationMint","pubkeyAsString"]]}],[v,{kind:"struct",fields:[["key","u8"],["supply","u64"],["maxSupply",{kind:"option",type:"u64"}]]}],[j,{kind:"struct",fields:[["key","u8"],["parent","pubkeyAsString"],["edition","u64"]]}],[y,{kind:"struct",fields:[["name","string"],["symbol","string"],["uri","string"],["sellerFeeBasisPoints","u16"],["creators",{kind:"option",type:[x]}]]}],[x,{kind:"struct",fields:[["address","pubkeyAsString"],["verified","u8"],["share","u8"]]}],[O,{kind:"struct",fields:[["key","u8"],["updateAuthority","pubkeyAsString"],["mint","pubkeyAsString"],["data",y],["primarySaleHappened","u8"],["isMutable","u8"]]}],[g,{kind:"struct",fields:[["key","u8"],["ledger",[31]]]}]]),C=new RegExp("\0","g"),E=function(e){var t=Object(f.deserializeUnchecked)(B,O,e);return t.data.name=t.data.name.replace(C,""),t.data.uri=t.data.uri.replace(C,""),t.data.symbol=t.data.symbol.replace(C,""),t};function T(e){return M.apply(this,arguments)}function M(){return(M=Object(o.a)(c.a.mark((function t(n){var r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(d.a)(),t.next=3,Object(p.e)([e.from(b),Object(p.h)(r.metadata).toBuffer(),Object(p.h)(n).toBuffer(),e.from(h)],Object(p.h)(r.metadata));case 3:return t.abrupt("return",t.sent[0]);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var z=function(){var t=Object(o.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.d.findProgramAddress([e.from("metadata"),p.c.toBuffer(),n.toBuffer()],p.c);case 2:return t.abrupt("return",t.sent[0]);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}).call(this,n(16).Buffer)},184:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return x})),n.d(t,"c",(function(){return y}));var r=n(14),a=n(26),i=n(25),c=n(2),o=n.n(c),s=n(7),u=n(10),l=n(5),d=n(41),f=n(8),p=n(55),b=n(35),h=n(160),m=function e(t){Object(u.a)(this,e),this.instruction=0,this.hasMetadata=void 0,this.makerSize=void 0,this.takerSize=void 0,this.bumpSeed=void 0,this.hasMetadata=t.hasMetadata,this.makerSize=t.makerSize,this.takerSize=t.takerSize,this.bumpSeed=t.bumpSeed};m.schema=new Map([[m,{kind:"struct",fields:[["instruction","u8"],["hasMetadata","u8"],["makerSize","u64"],["takerSize","u64"],["bumpSeed","u8"]]}]]);var v=function(){var t=Object(s.a)(o.a.mark((function t(n,r,a,i,c,s,u,d,h,v,g,j){var x,y,O;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return x=new m({hasMetadata:!1,makerSize:v,takerSize:g,bumpSeed:j}),y=e.from(Object(p.serialize)(m.schema,x)),O=[{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:h,isSigner:!1,isWritable:!1},{pubkey:b.d,isSigner:!1,isWritable:!1}],d.toBase58()===b.c.toBase58()&&O.push({pubkey:l.f.programId,isSigner:!1,isWritable:!1}),t.abrupt("return",{ix:[new l.h({keys:O,programId:f.b,data:y})]});case 5:case"end":return t.stop()}}),t)})));return function(e,n,r,a,i,c,o,s,u,l,d,f){return t.apply(this,arguments)}}(),g=function(){var t=Object(s.a)(o.a.mark((function t(n,r,a,c,s,u,d,h,v,g,j,x,y){var O,k,w;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return O=new m({hasMetadata:!0,makerSize:j,takerSize:x,bumpSeed:y}),k=e.from(Object(p.serialize)(m.schema,O)),w=[{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:h,isSigner:!1,isWritable:!1},{pubkey:v,isSigner:!1,isWritable:!1},{pubkey:b.d,isSigner:!1,isWritable:!1}],h.toBase58()===b.c.toBase58()&&w.push({pubkey:l.f.programId,isSigner:!1,isWritable:!1}),w.push.apply(w,Object(i.a)(g)),t.abrupt("return",{ix:[new l.h({keys:w,programId:f.b,data:k})]});case 6:case"end":return t.stop()}}),t)})));return function(e,n,r,a,i,c,o,s,u,l,d,f,p){return t.apply(this,arguments)}}(),j=function(){var e=Object(s.a)(o.a.mark((function e(t,n,r,i,c){var s,u,p,h,m,v,g,j,x,y;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.publicKey){e.next=3;break}return Object(f.f)({message:"Wallet not connected!"}),e.abrupt("return",!1);case 3:return s=[],u=[],e.next=7,l.d.findProgramAddress([r.publicKey.toBuffer(),b.d.toBuffer(),n.toBuffer()],f.a);case 7:p=e.sent[0],Object(f.d)(u,p,r.publicKey,r.publicKey,n),h=Object(a.a)(i);try{for(h.s();!(m=h.n()).done;)v=m.value,g=v.pubkey,j=v.size,x=b.e.createTransferInstruction(b.d,g,p,r.publicKey,[],j),y=b.e.createCloseAccountInstruction(b.d,g,r.publicKey,r.publicKey,[]),u.push.apply(u,[x,y])}catch(o){h.e(o)}finally{h.f()}return e.next=13,d.c.sendTransactionWithRetry(t,r,[].concat(u),s,"max");case 13:if(e.sent){e.next=19;break}return Object(f.f)({message:"Consolidation Failed"}),e.abrupt("return",!1);case 19:return Object(f.f)({message:"Successfully merged all token accounts into 1 Assoicated Token Account"}),c([]),e.abrupt("return",!0);case 22:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}(),x=function(){var t=Object(s.a)(o.a.mark((function t(n,r,a,i,c,s,u,p,h){var m,v,g,j,x,y,O,k=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(m=!(k.length>9&&void 0!==k[9])||k[9],s.publicKey){t.next=4;break}return Object(f.f)({message:"Wallet not connected!"}),t.abrupt("return",!1);case 4:return v=[],g=[],t.next=8,l.d.findProgramAddress([s.publicKey.toBuffer(),b.d.toBuffer(),r.toBuffer()],f.a);case 8:return j=t.sent[0],t.next=11,n.getAccountInfo(j);case 11:if(t.sent){t.next=15;break}return Object(f.f)({message:"User must have ATA to create offer"}),t.abrupt("return",!1);case 15:return t.next=17,l.d.findProgramAddress([s.publicKey.toBuffer(),b.d.toBuffer(),a.toBuffer()],f.a);case 17:return x=t.sent[0],t.next=20,n.getAccountInfo(x);case 20:return t.sent||Object(f.d)(g,x,s.publicKey,s.publicKey,a),x=a.toBase58()===b.c.toBase58()?s.publicKey:x,t.next=25,l.d.findProgramAddress([e.from("stateless_offer"),s.publicKey.toBuffer(),r.toBuffer(),a.toBuffer(),new Uint8Array(i.toArray("le",8)),new Uint8Array(c.toArray("le",8))],f.b);case 25:return y=t.sent[0],O=m?b.e.createApproveInstruction(b.d,j,y,s.publicKey,[],i.toNumber()):b.e.createRevokeInstruction(b.d,j,s.publicKey,[]),t.next=29,d.c.sendTransactionWithRetry(n,s,[].concat(g,[O]),v,"max");case 29:if(t.sent){t.next=35;break}return Object(f.f)({message:"Delegation transaction failed"}),t.abrupt("return",!1);case 35:return m?(p(!0),u(!0),Object(f.f)({message:"Successfully assigned delegate (".concat(y.toBase58(),")")})):(p(!1),Object(f.f)({message:"Successfully removed delegate (".concat(y.toBase58(),")")})),t.abrupt("return",!0);case 37:case"end":return t.stop()}}),t)})));return function(e,n,r,a,i,c,o,s,u){return t.apply(this,arguments)}}(),y=function(){var t=Object(s.a)(o.a.mark((function t(n,c,s,u,p,m,j,x,y){var O,k,w,S,A,B,C,E,T,M,z,P,I,F,W,K,L,N,R,U,D,V,H,q,_,G,J,Q,Y,X,Z,$,ee,te,ne,re,ae,ie;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:O=0,k=[s.toBase58(),u.toBase58()];case 1:if(!(O<k.length)){t.next=21;break}if((w=k[O])in j){t.next=18;break}return t.next=6,Object(h.b)(new l.d(w));case 6:return S=t.sent,t.prev=7,t.next=10,n.getAccountInfo(S);case 10:if(A=t.sent)try{B=Object(h.a)(A.data),j[w]={pubkey:S,account:B}}catch(o){console.log("Failed to decode metadata for mint:",w)}t.next=18;break;case 14:return t.prev=14,t.t0=t.catch(7),Object(f.f)({message:"Network request to fetch mint metadata failed"}),t.abrupt("return",!1);case 18:O++,t.next=1;break;case 21:if(C=s.toBase58()in j,E=u.toBase58()in j,y.publicKey){t.next=26;break}return Object(f.f)({message:"Wallet not connected!"}),t.abrupt("return",!1);case 26:return T=[],M=[],t.next=30,l.d.findProgramAddress([c.toBuffer(),b.d.toBuffer(),s.toBuffer()],f.a);case 30:return z=t.sent[0],t.next=33,n.getAccountInfo(z);case 33:if(t.sent){t.next=36;break}return Object(f.f)({message:"Maker must have ATA for mint A"}),t.abrupt("return",!1);case 36:return t.next=38,l.d.findProgramAddress([c.toBuffer(),b.d.toBuffer(),u.toBuffer()],f.a);case 38:return P=t.sent[0],t.next=41,n.getAccountInfo(P);case 41:if(t.sent){t.next=44;break}return Object(f.f)({message:"Maker must have ATA for mint B"}),t.abrupt("return",!1);case 44:return t.next=46,l.d.findProgramAddress([y.publicKey.toBuffer(),b.d.toBuffer(),s.toBuffer()],f.a);case 46:return I=t.sent[0],t.next=49,n.getAccountInfo(I);case 49:return t.sent||Object(f.d)(M,I,y.publicKey,y.publicKey,s),t.next=53,l.d.findProgramAddress([y.publicKey.toBuffer(),b.d.toBuffer(),u.toBuffer()],f.a);case 53:return F=t.sent[0],t.next=56,n.getAccountInfo(new l.d(F));case 56:if(W=t.sent,K=u.toBase58()===b.c.toBase58(),W||K){t.next=61;break}return Object(f.f)({message:"Taker must have ATA for mint B"}),t.abrupt("return",!1);case 61:return P=K?c:P,F=K?y.publicKey:F,t.next=65,l.d.findProgramAddress([e.from("stateless_offer"),c.toBuffer(),s.toBuffer(),u.toBuffer(),new Uint8Array(p.toArray("le",8)),new Uint8Array(m.toArray("le",8))],f.b);case 65:if(L=t.sent,N=Object(r.a)(L,2),R=N[0],U=N[1],V="",E||C){t.next=82;break}return t.next=73,v(c,y.publicKey,z,P,F,I,s,u,R,p,m,U);case 73:return H=t.sent,q=H.ix,_=q,console.log("Executing trade (pure swap)"),t.next=79,d.c.sendTransactionWithRetry(n,y,[].concat(M,Object(i.a)(_)),T,"max");case 79:D=t.sent,t.next=148;break;case 82:if(!j){t.next=148;break}if(t.prev=83,!(s.toBase58()in j)){t.next=89;break}G=s,J=u,t.next=96;break;case 89:if(!(u.toBase58()in j)){t.next=94;break}G=u,J=s,t.next=96;break;case 94:return Object(f.f)({message:"Neither seller or buyer mint has valid metadata"}),t.abrupt("return",!1);case 96:if(Q=[],Y=j[G.toBase58()].account.data.creators){t.next=101;break}return Object(f.f)({message:"Trade transaction failed: specified metadata has invalid creators"}),t.abrupt("return",!1);case 101:if(X=j[G.toBase58()].pubkey){t.next=105;break}return Object(f.f)({message:"Trade transaction failed: metadata account is undefined"}),t.abrupt("return",!1);case 105:Q.push({pubkey:X,isSigner:!1,isWritable:!1}),Z=Object(a.a)(Y),t.prev=107,Z.s();case 109:if(($=Z.n()).done){t.next=124;break}if(ee=$.value,te=new l.d(ee.address),Q.push({pubkey:te,isSigner:!1,isWritable:!0}),K){t.next=122;break}return t.next=116,l.d.findProgramAddress([te.toBuffer(),b.d.toBuffer(),J.toBuffer()],f.a);case 116:return ne=t.sent[0],t.next=119,n.getAccountInfo(ne);case 119:t.sent||Object(f.d)(M,ne,y.publicKey,te,J),Q.push({pubkey:ne,isSigner:!1,isWritable:!0});case 122:t.next=109;break;case 124:t.next=129;break;case 126:t.prev=126,t.t1=t.catch(107),Z.e(t.t1);case 129:return t.prev=129,Z.f(),t.finish(129);case 132:return t.next=134,g(c,y.publicKey,z,P,F,I,s,u,R,Q,p,m,U);case 134:return re=t.sent,ae=re.ix,ie=ae,console.log("Executing trade (metadata and creators supplied)"),t.next=140,d.c.sendTransactionWithRetry(n,y,[].concat(M,Object(i.a)(ie)),T,"max");case 140:D=t.sent,V=" (Creator Fees Paid)",t.next=148;break;case 144:t.prev=144,t.t2=t.catch(83),console.log(t.t2),console.log("Encountered error while processing metadata");case 148:if(D){t.next=153;break}return Object(f.f)({message:"Trade transaction failed"}),t.abrupt("return",!1);case 153:return Object(f.f)({message:"Trade successful".concat(V)}),x(!1),t.abrupt("return",!0);case 156:case"end":return t.stop()}}),t,null,[[7,14],[83,144],[107,126,129,132]])})));return function(e,n,r,a,i,c,o,s,u){return t.apply(this,arguments)}}()}).call(this,n(16).Buffer)},209:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n(0);var r=n(300),a=n(4);function i(e){var t=e.message,n=void 0===t?"":t,i=e.description,c=void 0===i?void 0:i,o=e.txid,s=void 0===o?"":o,u=e.type,l=void 0===u?"info":u,d=e.placement,f=void 0===d?"bottomLeft":d;s&&(c=Object(a.jsx)(a.Fragment,{})),r.a[l]({message:Object(a.jsx)("span",{style:{color:"black"},children:n}),description:Object(a.jsx)("span",{style:{color:"black",opacity:.5},children:c}),placement:f,style:{backgroundColor:"white"}})}},210:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n(0);var r=n(735),a=n(82),i=n(4),c=function(e){var t,n,c=e.type,o=e.code,s="string"===typeof e.address?e.address:null===(t=e.address)||void 0===t?void 0:t.toBase58();if(!s)return null;var u=null!==(n=e.length)&&void 0!==n?n:9;return Object(i.jsx)("a",{href:"https://explorer.solana.com/".concat(c,"/").concat(s),target:"_blank",rel:"noreferrer",title:s,style:e.style,children:o?Object(i.jsx)(r.a.Text,{style:e.style,code:!0,children:Object(a.c)(s,u)}):Object(a.c)(s,u)})}},211:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(19),a=n(10),i=n(111),c=function e(t,n,r,i){Object(a.a)(this,e),this.id=void 0,this.parser=void 0,this.isNew=void 0,this.isActive=void 0,this.id=t,this.parser=r,this.isNew=n,this.isActive=i};c.type="CacheUpdate";var o=function e(t){Object(a.a)(this,e),this.id=void 0,this.id=t};o.type="CacheUpdate";var s=function e(t){Object(a.a)(this,e),this.ids=void 0,this.ids=t};s.type="MarketUpdate";var u=function(){function e(){Object(a.a)(this,e),this.emitter=new i.EventEmitter}return Object(r.a)(e,[{key:"onMarket",value:function(e){var t=this;return this.emitter.on(s.type,e),function(){return t.emitter.removeListener(s.type,e)}}},{key:"onCache",value:function(e){var t=this;return this.emitter.on(c.type,e),function(){return t.emitter.removeListener(c.type,e)}}},{key:"raiseMarketUpdated",value:function(e){this.emitter.emit(s.type,new s(e))}},{key:"raiseCacheUpdated",value:function(e,t,n,r){this.emitter.emit(c.type,new c(e,t,n,r))}},{key:"raiseCacheDeleted",value:function(e){this.emitter.emit(o.type,new o(e))}}]),e}()},212:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(2),a=n.n(r),i=n(7),c=n(0),o=n(73),s=n(41),u=n(8),l=n(302),d=n(727),f=n(304),p=n(729),b=n(120),h=n(89),m=n(736),v=n(418),g=n.n(v),j=n(417),x=n.n(j),y=n(4),O=function(e){var t=e.additionalSettings,n=Object(o.b)(),r=n.connected,v=n.disconnect,j=n.publicKey,O=Object(s.l)(),k=O.setEndpoint,w=O.env,S=O.endpoint,A=Object(s.n)().setVisible,B=Object(c.useCallback)((function(){return A(!0)}),[A]),C=Object(s.m)().setModal,E=Object(h.a)(),T=Object(s.j)(),M=Object(c.useCallback)((function(){C(s.f.WALLET),A(!0)}),[C,A]);return Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)(d.a,{sx:{display:"flex",minWidth:"100%"},children:[!r&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(f.a,{children:Object(y.jsx)(p.a,{style:{marginBottom:5},onChange:function(e){k(e.target.value)},value:S,children:s.e.map((function(e){var t=e.name,n=e.endpoint;return Object(y.jsx)("option",{value:n,children:t},t)}))})}),Object(y.jsx)(b.a,{variant:"contained",onClick:M,sx:{marginLeft:"10px"},children:"Connect"})]}),r&&Object(y.jsxs)(y.Fragment,{children:[j&&Object(y.jsxs)(b.a,{variant:"outlined",onClick:Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=4;break}return e.next=3,navigator.clipboard.writeText(j.toBase58());case 3:Object(u.f)({message:"Wallet update",description:"Address copied to clipboard"});case 4:case"end":return e.stop()}}),e)}))),children:[Object(y.jsx)(l.a,{}),Object(u.g)(j.toBase58())]}),Object(y.jsx)(b.a,{variant:"outlined",onClick:B,sx:{marginLeft:"10px"},children:"Change Wallet"}),Object(y.jsxs)(b.a,{variant:"contained",color:"error",onClick:function(){return v().catch()},sx:{marginLeft:"10px"},children:["Disconnect (",w,")"]})]}),Object(y.jsx)(m.a,{sx:{ml:1},onClick:T.toggleColorMode,color:"inherit",children:"dark"===E.palette.mode?Object(y.jsx)(x.a,{}):Object(y.jsx)(g.a,{})}),t]})})}},238:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u.a}));var r=n(29),a=n(116),i=(n(0),n(775)),c=(n(713),n(4)),o=["children","closeIcon","bodyStyle","style"],s=function(e){var t=e.children,n=(e.closeIcon,e.bodyStyle),s=(e.style,Object(a.a)(e,o));return Object(c.jsx)(i.a,Object(r.a)(Object(r.a)({style:{background:"transparent",borderRadius:16},bodyStyle:Object(r.a)({background:"#333333",display:"flex",flexDirection:"column",alignItems:"center"},n),footer:null,width:400},s),{},{children:t}))},u=(n(210),n(212),n(401))},397:function(e,t,n){"use strict";(function(e){n(25),n(5),n(44),n(95)}).call(this,n(16).Buffer)},398:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));n(35);var r=n(5),a=n(49);n(50),n(112);function i(t,n,i,c,o){var s=[{pubkey:i,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:r.f.programId,isSigner:!1,isWritable:!1},{pubkey:a.g,isSigner:!1,isWritable:!1},{pubkey:r.e,isSigner:!1,isWritable:!1}];t.push(new r.h({keys:s,programId:a.c,data:e.from([])}))}}).call(this,n(16).Buffer)},401:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return L}));var r=n(11),a=n(29),i=n(26),c=n(2),o=n.n(c),s=n(7),u=n(14),l=n(0),d=n(429),f=n(120),p=n(436),b=n(432),h=n(304),m=n(433),v=n(431),g=n(435),j=n(434),x=n(303),y=n(41),O=n(8),k=n(35),w=n(184),S=n(5),A=n(44),B=n.n(A),C=n(73),E=n(94),T=n(430),M=n(160),z=(n(718),n(4)),P=["None","SOL","USDC","USDT","BTC","ETH"],I=function(e,t,n){try{var r=n[t].decimals;return Math.floor(parseFloat(e)*Math.pow(10,r))}catch(a){return 0}},F=function(e,t,n){var r=function(e,t){try{if(e.mintA in t){var n=t[e.mintA].account.data.sellerFeeBasisPoints,r=parseFloat(e.sizeB);return[!0,r,r*n/1e4,n]}if(e.mintB in t){var a=t[e.mintB].account.data.sellerFeeBasisPoints,i=parseFloat(e.sizeA);return[!1,i,i*a/1e4,a]}return[!0,0,0,0]}catch(c){return[!0,0,0,0]}}(t,n),a=Object(u.a)(r,4),i=a[0],c=a[1],o=a[2],s=a[3],l=i&&!e||!i&&e;if(s<=0)return null;var d=(s/100).toFixed(2);if(l){var f=i?"Buyer":"Seller";return Object(z.jsx)("div",{style:{marginLeft:"12px",marginTop:"2px",fontSize:12,textAlign:"left"},children:"* ".concat(f," will pay a ").concat(d,"% fee on trade (pays ~").concat(o.toFixed(4),")")})}var p=i?"Seller":"Buyer";return Object(z.jsx)("div",{style:{marginLeft:"12px",marginTop:"2px",fontSize:12,textAlign:"left"},children:"* ".concat(p," will receive ").concat(d,"% less on trade due to fees (receives ~").concat((c-o).toFixed(4),")")})},W=function(){var t=Object(s.a)(o.a.mark((function t(n,r,a){var i,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=I(n.sizeA,n.mintA,r),c=I(n.sizeB,n.mintB,r),t.next=5,S.d.findProgramAddress([e.from("stateless_offer"),new S.d(n.maker).toBuffer(),new S.d(n.mintA).toBuffer(),new S.d(n.mintB).toBuffer(),new Uint8Array(new B.a(i).toArray("le",8)),new Uint8Array(new B.a(c).toArray("le",8))],O.b);case 5:return t.abrupt("return",t.sent[0]);case 8:return t.prev=8,t.t0=t.catch(0),console.log("Failed to get delegate. Metadata:",a),t.abrupt("return",null);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n,r){return t.apply(this,arguments)}}(),K=function(e,t,n){if(e&&t&&t[n]){var r="https://explorer.solana.com/address/".concat(t[n],"?cluster=").concat(e);return window.open(r,"_blank")}return!1};function L(){var e=Object(y.k)(),t=Object(C.b)(),n=Object(y.l)().env,c=Object(l.useState)(function(){var e,t=new URL(window.location.href),n=new URLSearchParams(t.search.slice(1)),r={mintA:"",mintB:"",sizeA:"0",sizeB:"0",maker:""},a=Object(i.a)(n.keys());try{for(a.s();!(e=a.n()).done;){var c=e.value;r[c]=n.get(c)}}catch(o){a.e(o)}finally{a.f()}return r}()),A=Object(u.a)(c,2),L=A[0],N=A[1],R=Object(l.useState)({}),U=Object(u.a)(R,2),D=U[0],V=U[1],H=Object(l.useState)({}),q=Object(u.a)(H,2),_=q[0],G=q[1],J=Object(l.useState)({}),Q=Object(u.a)(J,2),Y=Q[0],X=Q[1],Z=Object(l.useState)(0),$=Object(u.a)(Z,2),ee=$[0],te=$[1],ne=Object(l.useState)(!1),re=Object(u.a)(ne,2),ae=re[0],ie=re[1],ce=Object(l.useState)(!1),oe=Object(u.a)(ce,2),se=oe[0],ue=oe[1],le=Object(l.useState)(!1),de=Object(u.a)(le,2),fe=de[0],pe=de[1],be=Object(l.useState)(!1),he=Object(u.a)(be,2),me=he[0],ve=he[1],ge=Object(l.useState)(!1),je=Object(u.a)(ge,2),xe=je[0],ye=je[1],Oe=Object(l.useState)(!1),ke=Object(u.a)(Oe,2),we=ke[0],Se=ke[1],Ae=Object(l.useState)([]),Be=Object(u.a)(Ae,2),Ce=Be[0],Ee=Be[1],Te=Object(l.useState)(null),Me=Object(u.a)(Te,2),ze=Me[0],Pe=Me[1],Ie=Object(l.useState)(null),Fe=Object(u.a)(Ie,2),We=Fe[0],Ke=Fe[1],Le=Object(l.useState)(!1),Ne=Object(u.a)(Le,2),Re=Ne[0],Ue=Ne[1],De=Object(l.useState)(!1),Ve=Object(u.a)(De,2),He=Ve[0],qe=Ve[1],_e=!1,Ge=Object(l.useState)({}),Je=Object(u.a)(Ge,2),Qe=Je[0],Ye=Je[1],Xe=Object(l.useState)(new Map),Ze=Object(u.a)(Xe,2),$e=Ze[0],et=Ze[1];Object(l.useEffect)((function(){console.log("RESET"),t.connected||(console.log("Wallet disconnected, resetting state"),G({}),ie(!1),ue(!1),X({}),pe(!1),ve(!1))}),[t.connected,t.publicKey]),Object(l.useEffect)((function(){console.log("TOKEN LOOKUP"),(new E.b).resolve().then((function(e){var t;"devnet"===n?t=e.filterByChainId(E.a.Devnet).getList():"mainnet-beta"===n?t=e.filterByChainId(E.a.MainnetBeta).getList():"testnet"===n&&(t=e.filterByChainId(E.a.Testnet).getList()),et(t.reduce((function(e,t){return e.set(t.symbol,t),e}),new Map))}))}),[et,n]),Object(l.useEffect)((function(){var e;console.log("SET SELLER"),t&&ie((null===(e=t.publicKey)||void 0===e?void 0:e.toBase58())===L.maker)}),[L.maker,t,ie]),Object(l.useEffect)((function(){console.log("VALIDATE TOKEN ACCOUNT");var e=function(){var e=Object(s.a)(o.a.mark((function e(){var t,n,r,a,i,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=D).mint){e.next=3;break}return e.abrupt("return");case 3:if((n=t.mint.toBase58())in Y){r=Y[n].decimals,a=t.amount*Math.pow(10,-r);try{i=parseFloat(L.sizeA),ue(a>=i&&i>0)}catch(o){console.log("Not a valid float")}}return e.next=7,W(L,Y,Qe[L.mintA]);case 7:c=e.sent,pe(0!==t.delegateOption),t.delegate&&c&&0!==t.delegateOption&&c.toBase58()===t.delegate.toBase58()?ve(!0):ve(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[D,Y,L,Qe]),Object(l.useEffect)((function(){var n;if(console.log("FETCH SELLER TOKEN ACCOUNT"),t.connected){var r=function(){var t=Object(s.a)(o.a.mark((function t(){var r,a,c,u,l,d,f,p,b,h,m;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=new S.d(L.maker),a=new S.d(L.mintA),t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return");case 8:return t.next=10,S.d.findProgramAddress([r.toBuffer(),k.d.toBuffer(),a.toBuffer()],O.a);case 10:return c=t.sent[0],t.next=13,e.getAccountInfo(c);case 13:if(!(u=t.sent)){t.next=18;break}try{l=Object(y.h)(u.data),V(l)}catch(v){console.log("Failed to deserialize account")}t.next=28;break;case 18:return t.prev=18,t.next=21,e.getTokenAccountsByOwner(r,{mint:a});case 21:d=t.sent,t.next=27;break;case 24:return t.prev=24,t.t1=t.catch(18),t.abrupt("return");case 27:if(d.value){f=[],p=Object(i.a)(d.value);try{for(p.s();!(b=p.n()).done;){h=b.value;try{m=Object(y.h)(h.account.data).amount,f.push({pubkey:h.pubkey,size:m})}catch(v){console.log("Failed to deserialize account",v)}}}catch(g){p.e(g)}finally{p.f()}console.log(f),Ee(f)}case 28:n=e.onAccountChange(c,function(){var e=Object(s.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){console.log("Received account data");try{n=Object(y.h)(t.data),V(n)}catch(v){console.log("Failed to deserialize account",v)}}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 29:case"end":return t.stop()}}),t,null,[[0,5],[18,24]])})));return function(){return t.apply(this,arguments)}}();return r(),function(){n&&e.removeAccountChangeListener(n)}}}),[L.maker,L.mintA,e,V,t.connected]),Object(l.useEffect)((function(){var n;if(console.log("FETCH BUYER TOKEN ACCOUNT"),t.connected&&t.publicKey){var r=function(){var r=Object(s.a)(o.a.mark((function r(){var a,c,u,l,d,f,p,b,h,m,v,g;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.prev=0,a=t.publicKey,c=new S.d(L.mintB),r.next=8;break;case 5:return r.prev=5,r.t0=r.catch(0),r.abrupt("return");case 8:return r.prev=8,r.next=11,e.getAccountInfo(a);case 11:(u=r.sent)&&te(u.lamports),r.next=18;break;case 15:r.prev=15,r.t1=r.catch(8),console.log("Failed to fetch wallet");case 18:return r.next=20,S.d.findProgramAddress([a.toBuffer(),k.d.toBuffer(),c.toBuffer()],O.a);case 20:return l=r.sent[0],r.prev=21,r.next=24,e.getAccountInfo(l);case 24:d=r.sent,r.next=30;break;case 27:r.prev=27,r.t2=r.catch(21),console.log("Failed to fetch Buyer ATA");case 30:if(!d){r.next=34;break}try{f=Object(y.h)(d.data),G(f)}catch(j){console.log("Failed to deserialize account")}r.next=44;break;case 34:return r.prev=34,r.next=37,e.getTokenAccountsByOwner(a,{mint:c});case 37:p=r.sent,r.next=43;break;case 40:return r.prev=40,r.t3=r.catch(34),r.abrupt("return");case 43:if(p.value){b=[],h=Object(i.a)(p.value);try{for(h.s();!(m=h.n()).done;){v=m.value;try{g=Object(y.h)(v.account.data).amount,b.push({pubkey:v.pubkey,size:g})}catch(j){console.log("Failed to deserialize account",j)}}}catch(x){h.e(x)}finally{h.f()}Ee(b)}case 44:n=e.onAccountChange(l,function(){var e=Object(s.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){console.log("Received account data");try{n=Object(y.h)(t.data),G(n)}catch(j){console.log("Failed to deserialize account",j)}}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 45:case"end":return r.stop()}}),r,null,[[0,5],[8,15],[21,27],[34,40]])})));return function(){return r.apply(this,arguments)}}();return r(),function(){n&&e.removeAccountChangeListener(n)}}console.log("Wallet disconnected, can't fetch buyer token account")}),[L.maker,L.mintB,e,G,t.publicKey,t.connected]),Object(l.useEffect)((function(){if(console.log("FETCH MINT ACCOUNTS"),t.connected){var n=function(){var t=Object(s.a)(o.a.mark((function t(){var n,i,c,s,u,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=0,c=[L.mintA,L.mintB];case 1:if(!(i<c.length)){t.next=26;break}s=c[i],t.prev=3,n=new S.d(s),t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(3),t.abrupt("continue",23);case 10:if(n.toBase58()in Y){t.next=23;break}return t.next=13,e.getAccountInfo(n);case 13:if(!(u=t.sent)){t.next=23;break}t.prev=15,l=Object(y.i)(u.data),X(Object(a.a)(Object(a.a)({},Y),{},Object(r.a)({},s,l))),t.next=23;break;case 20:return t.prev=20,t.t1=t.catch(15),t.abrupt("continue",23);case 23:i++,t.next=1;break;case 26:case"end":return t.stop()}}),t,null,[[3,7],[15,20]])})));return function(){return t.apply(this,arguments)}}();n()}}),[Y,L.mintA,L.mintB,e,t.connected]),Object(l.useEffect)((function(){if(console.log("FETCH METADATA ACCOUNTS"),t.connected){var n=function(){var t=Object(s.a)(o.a.mark((function t(){var n,i,c,s,u,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0,i=[L.mintA,L.mintB];case 1:if(!(n<i.length)){t.next=26;break}if((c=i[n])in Y){t.next=5;break}return t.abrupt("return");case 5:if(!(c in Qe)){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,Object(M.b)(new S.d(c));case 9:return s=t.sent,t.next=12,e.getAccountInfo(s);case 12:if(!(u=t.sent)){t.next=23;break}return t.prev=14,l=Object(M.a)(u.data),Ye(Object(a.a)(Object(a.a)({},Qe),{},Object(r.a)({},c,{pubkey:s,account:l}))),t.abrupt("break",26);case 20:return t.prev=20,t.t0=t.catch(14),t.abrupt("continue",23);case 23:n++,t.next=1;break;case 26:case"end":return t.stop()}}),t,null,[[14,20]])})));return function(){return t.apply(this,arguments)}}();n()}}),[Y,L.mintA,L.mintB,Ye,e,t.connected]);var tt=function(e){return function(t){N(Object(a.a)(Object(a.a)({},L),{},Object(r.a)({},e,t.target.value)));var n=new URL(window.location.href),i=new URLSearchParams(n.search.slice(1));i.set(e,escape(t.target.value));var c=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+i.toString();window.history.pushState({path:c},"",c)}},nt=function(e){if(e in L)return L[e]},rt=function(e){"Enter"===e.key&&(ye(!1),Se(!1))},at=function(e){Pe(null),Ue(!1)},it=function(e){Ke(null),qe(!1)},ct=function(e,t){var n=[];n.push(Object(z.jsx)(p.a,{onKeyPress:rt,inputProps:{sx:{marginLeft:"15px"},value:nt(t),placeholder:"Enter the desired mint public key (or select from known mints)"},sx:{width:"60ch"},value:nt(t),fullWidth:!0,onChange:function(e){tt(t)(e)},onClick:function(e){_e=!0},onKeyDown:function(e){return e.stopPropagation()}},t));var r,a=Object(i.a)(P);try{for(a.s();!(r=a.n()).done;){var c=r.value;e.get(c)?n.push(Object(z.jsx)(b.a,{sx:{width:"60ch"},value:e.get(c).address,children:c},c)):"None"===c&&n.push(Object(z.jsx)(b.a,{value:"",sx:{width:"60ch",fontStyle:"italic"},children:c},c))}}catch(o){a.e(o)}finally{a.f()}return n};return Object(z.jsxs)("div",{children:[Object(z.jsx)("div",{children:Object(z.jsxs)(d.a,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"60ch"},justifyContent:"center",marginBottom:"10px"},noValidate:!0,autoComplete:"on",children:[Object(z.jsx)(j.a,{onClick:function(){var e=K(n,L,"mintA");e&&e.focus()},onMouseOver:function(e){Pe(e.currentTarget),Ue(!0)},onMouseOut:at,disabled:!(L.mintA&&L.mintA in Y),color:"secondary",sx:{width:"30ch"},variant:"contained","aria-owns":Re?"mouse-popoverA":void 0,"aria-haspopup":"true",children:"Seller Mint (Explorer)"}),Object(z.jsx)(T.a,{id:"mouse-popoverA",sx:{pointerEvents:"none"},open:Re,anchorEl:ze,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"},onClose:at,children:Object(z.jsx)("object",{data:"https://explorer.solana.com/address/".concat(L.mintA,"/?cluster=").concat(n),width:"500",height:"500"})}),Object(z.jsx)(j.a,{onClick:function(){var e=K(n,L,"mintB");e&&e.focus()},onMouseOver:function(e){Ke(e.currentTarget),qe(!0)},onMouseOut:it,disabled:!(L.mintB&&L.mintB in Y),color:"secondary",sx:{width:"30ch",marginLeft:"10px"},variant:"contained","aria-owns":He?"mouse-popoverB":void 0,"aria-haspopup":"true",children:"Buyer Mint (Explorer)"}),Object(z.jsx)(T.a,{id:"mouse-popoverB",sx:{pointerEvents:"none"},open:He,anchorEl:We,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"},onClose:it,children:Object(z.jsx)("object",{data:"https://explorer.solana.com/address/".concat(L.mintB,"/?cluster=").concat(n),width:"500",height:"500"})})]})}),Object(z.jsx)("div",{children:Object(z.jsxs)(d.a,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"60ch"}},noValidate:!0,autoComplete:"on",children:[Object(z.jsxs)("div",{children:[Object(z.jsx)(x.a,{required:!0,id:"outlined-required",label:"Seller Public Key",value:nt("maker"),onChange:tt("maker")}),Object(z.jsxs)(h.a,{sx:{marginTop:"8px",marginBottom:"15px"},children:[Object(z.jsx)(m.a,{id:"seller-mint",children:"Seller Mint"}),Object(z.jsx)(v.a,{sx:{textAlign:"left",width:"60ch"},labelId:"seller-mint",value:nt("mintA"),input:Object(z.jsx)(g.a,{label:"Seller Mint"}),onChange:function(e){tt("mintA")(e)},open:xe,onClose:function(e){_e?_e=!1:ye(!1)},onOpen:function(e){ye(!0),Se(!1)},MenuProps:{sx:{maxWidth:"60ch"}},renderValue:function(e){return e},children:ct($e,"mintA")})]}),Object(z.jsxs)(h.a,{sx:{marginBottom:"5px"},children:[Object(z.jsx)(m.a,{id:"buyer-mint",children:"Buyer Mint"}),Object(z.jsx)(v.a,{sx:{textAlign:"left",width:"60ch"},style:{width:"60ch"},labelId:"buyer-mint",value:nt("mintB"),input:Object(z.jsx)(g.a,{label:"Buyer Mint"}),onChange:tt("mintB"),open:we,onClose:function(e){_e?_e=!1:Se(!1)},onOpen:function(e){ye(!1),Se(!0)},MenuProps:{sx:{width:"60ch"}},renderValue:function(e){return e},children:ct($e,"mintB")})]}),Object(z.jsx)(x.a,{id:"outlined-number",label:"Seller Size",type:"number",value:nt("sizeA"),onChange:tt("sizeA"),sx:{marginBottom:"5px"},InputLabelProps:{shrink:!0}}),Object(z.jsx)(x.a,{id:"outlined-number",label:"Buyer Size",type:"number",value:nt("sizeB"),onChange:tt("sizeB"),sx:{marginBottom:"2px"},InputLabelProps:{shrink:!0}})]}),F(ae,L,Qe),Object(z.jsx)("div",{style:{marginTop:"5px"},children:function(){var n=L.mintA in Y&&L.mintB in Y,r=I(L.sizeA,L.mintA,Y),a=I(L.sizeB,L.mintB,Y),i=!0;(!n||r<=0||a<=0||isNaN(r)||isNaN(a))&&(i=!1);var c=_&&"amount"in _&&i&&_.amount.toNumber()>=a,o=ee>=parseFloat(L.sizeB)*S.c,s=L.mintB===k.c.toBase58()?o:c,u=!ae&&me&&se&&s,l=ae&&se&&!me&&i,d=ae&&fe&&i;return Ce&&Ce.length&&Ce.length>0?Object(z.jsx)(f.a,{variant:"contained",color:"success",onClick:function(){if(L)try{Object(w.b)(e,ae?new S.d(L.mintA):new S.d(L.mintB),t,Ce,Ee)}catch(n){return}},sx:{marginRight:"4px"},children:"Consolidate Token Accounts"}):Object(z.jsxs)("div",{children:[!ae&&me&&se&&!s&&Object(z.jsx)("div",{style:{marginLeft:"12px",marginBottom:"5px",fontSize:12,textAlign:"left",color:"red"},children:"* Buyer has insufficient funds"}),Object(z.jsxs)("div",{children:[Object(z.jsx)(f.a,{variant:"contained",disabled:!l,onClick:function(){if(L)try{Object(w.a)(e,new S.d(L.mintA),new S.d(L.mintB),new B.a(r),new B.a(a),t,ve,pe,Qe)}catch(n){return}},children:"Open New Offer"}),Object(z.jsx)(f.a,{variant:"contained",color:"error",sx:{marginLeft:"10px"},disabled:!d,onClick:function(){if(L)try{Object(w.a)(e,new S.d(L.mintA),new S.d(L.mintB),new B.a(I(L.sizeA,L.mintA,Y)),new B.a(I(L.sizeB,L.mintB,Y)),t,ve,pe,Qe,!1)}catch(n){return}},children:"Close Existing Offer"}),Object(z.jsx)(f.a,{variant:"contained",color:"success",sx:{marginLeft:"10px"},disabled:!u,onClick:function(){if(L)try{Object(w.c)(e,new S.d(L.maker),new S.d(L.mintA),new S.d(L.mintB),new B.a(I(L.sizeA,L.mintA,Y)),new B.a(I(L.sizeB,L.mintB,Y)),Qe,ve,t)}catch(n){return}},children:"Trade"})]})]})}()})]})})]})}}).call(this,n(16).Buffer)},41:function(e,t,n){"use strict";n.d(t,"a",(function(){return r.a})),n.d(t,"h",(function(){return r.d})),n.d(t,"i",(function(){return r.e})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return a.ENDPOINTS})),n.d(t,"d",(function(){return a.ConnectionProvider})),n.d(t,"k",(function(){return a.useConnection})),n.d(t,"l",(function(){return a.useConnectionConfig})),n.d(t,"n",(function(){return h})),n.d(t,"g",(function(){return j})),n.d(t,"f",(function(){return m})),n.d(t,"m",(function(){return y})),n.d(t,"b",(function(){return w})),n.d(t,"j",(function(){return S}));var r=n(112),a=n(99),i=n(14),c=n(73),o=n(119),s=n(178),u=n(0),l=n.n(u),d=n(8),f=n(238),p=(n.p,n(4)),b=Object(u.createContext)({});function h(){return Object(u.useContext)(b)}var m,v=function(){var e=Object(c.b)(),t=e.wallets,n=e.wallet,r=e.select,a=h(),i=a.visible,o=a.setVisible,l=Object(u.useCallback)((function(){o(!1)}),[o]);return Object(p.jsxs)(f.a,{visible:i,onCancel:l,children:[Object(p.jsx)("div",{style:{background:"linear-gradient(180deg, #D329FC 0%, #8F6DDE 49.48%, #19E6AD 100%)",borderRadius:36,width:50,height:50,textAlign:"center",verticalAlign:"middle",fontWeight:700,fontSize:"1.3rem",lineHeight:2.4,marginBottom:10}}),Object(p.jsx)("h2",{style:{color:"white",fontWeight:"bold",fontSize:20},children:n?"Change provider":""}),Object(p.jsx)("p",{style:{color:"white",fontSize:14},children:n?"Choose from the following options:":"Please sign into your wallet"}),Object(p.jsx)("br",{}),t.map((function(e){return Object(p.jsx)(s.a,{size:"large",type:e===n?"primary":"ghost",onClick:function(){r(e.name),l()},icon:Object(p.jsx)("img",{alt:"".concat(e.name),width:20,height:20,src:e.icon,style:{marginRight:30,float:"left"}}),style:{display:"block",width:"100%",textAlign:"left",marginBottom:8,color:"white"},children:e.name},e.name)}))]})},g=function(e){var t=e.children,n=Object(c.b)().publicKey,r=Object(u.useState)(!!n),a=Object(i.a)(r,2),o=a[0],s=a[1],l=Object(u.useState)(!1),f=Object(i.a)(l,2),h=f[0],m=f[1];return Object(u.useEffect)((function(){if(n){var e=n.toBase58(),t=e.length>20?"".concat(e.substring(0,7),".....").concat(e.substring(e.length-7,e.length)):e;Object(d.f)({message:"Wallet update",description:"Connected to wallet "+t})}}),[n]),Object(u.useEffect)((function(){!n&&o&&Object(d.f)({message:"Wallet update",description:"Disconnected from wallet"}),s(!!n)}),[n,o,s]),Object(p.jsxs)(b.Provider,{value:{visible:h,setVisible:m},children:[t,Object(p.jsx)(v,{})]})},j=function(e){var t=e.children,n=Object(u.useMemo)((function(){return[Object(o.c)(),Object(o.d)(),Object(o.g)({options:{clientId:"BOM5Cl7PXgE9Ylq1Z1tqzhpydY0RVr8k90QQ85N7AKI5QGSrr9iDC-3rvmy0K_hF0JfpLMiXoDhta68JwcxS1LQ"}}),Object(o.a)(),Object(o.f)(),Object(o.b)(),Object(o.e)()]}),[]),r=Object(u.useCallback)((function(e){console.error(e),Object(d.f)({message:"Wallet error",description:e.message})}),[]);return Object(p.jsx)(c.a,{wallets:n,onError:r,autoConnect:!0,children:Object(p.jsx)(g,{children:t})})};!function(e){e.WALLET="wallet"}(m||(m={}));var x=l.a.createContext({setModal:function(){return null},removeModal:function(){return null}}),y=function(){var e=Object(u.useContext)(x);if(void 0===e)throw new Error("useModal must be used within a ModalProvider");return e},O=n(89),k=l.a.createContext({}),w=function(e){var t=e.children,n=void 0===t?null:t,r=l.a.useState("dark"),a=Object(i.a)(r,2),c=a[0],o=a[1],s=Object(O.a)();return Object(p.jsx)(k.Provider,{value:{toggleColorMode:function(){o((function(e){return"light"===e?"dark":"light"}))},mode:c,theme:s},children:n})},S=function(){return Object(u.useContext)(k)}},454:function(e,t){},455:function(e,t){},477:function(e,t){},478:function(e,t){},49:function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return p}));n(10),n(19);var r=n(5),a=new Map,i=function(e){if("string"!==typeof e)return e;var t=a.get(e);return t||(t=new r.d(e),a.set(e,t)),t},c=new r.d("So11111111111111111111111111111111111111112"),o=new r.d("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),s=new r.d("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),u=new r.d("BPFLoaderUpgradeab1e11111111111111111111111"),l=new r.d("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),d=new r.d("11111111111111111111111111111111"),f=new r.d("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),p=new r.d("SAtnofysr9Uxk7m9YphxwfL5E3wyZJWUzjwA29Gw3tQ")},50:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(2),n(7);var r=n(49),a=function(){return{token:r.g,associatedToken:r.c,bpf_upgrade_loader:r.a,system:r.e,memo:r.b,metadata:r.f}}},608:function(e,t){},610:function(e,t){},624:function(e,t){},628:function(e,t){},630:function(e,t){},641:function(e,t){},643:function(e,t){},670:function(e,t){},672:function(e,t){},677:function(e,t){},679:function(e,t){},686:function(e,t){},698:function(e,t){},701:function(e,t){},712:function(e,t){},713:function(e,t,n){},718:function(e,t,n){},724:function(e,t,n){},725:function(e,t,n){},726:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(45),c=n.n(i),o=n(41),s=(n(720),n(721),n(722),n(723),n(14)),u=(n(724),n(727)),l=n(29),d=n(116),f=n(781),p=n(212),b=n(4),h=["isConnected","onClickConnect","onClickChange"],m=function(e){e.isConnected,e.onClickConnect,e.onClickChange;var t=Object(d.a)(e,h);return Object(b.jsx)(f.a,Object(l.a)(Object(l.a)({},t),{},{children:Object(b.jsx)(p.a,{})}))},v=n(73),g=function(){var e=Object(o.m)().setModal,t=Object(o.n)().setVisible,n=Object(v.b)().connected,a=Object(r.useCallback)((function(){return t(!0)}),[t]),i=Object(r.useCallback)((function(){e(o.f.WALLET),t(!0)}),[e,t]);return Object(b.jsxs)(u.a,{sx:{display:"flex",bgcolor:"action.disabledBackground"},minWidth:"100%",children:[Object(b.jsx)(u.a,{sx:{flexGrow:1}}),Object(b.jsx)(u.a,{sx:{display:"flex",height:"62px",justifyContent:"flex-end",alignItems:"center"},children:Object(b.jsx)(m,{isConnected:n,sx:{marginRight:"36px"},onClickConnect:i,onClickChange:a})})]})},j=n(238),x=n(299),y=n(778),O=n(774),k=n(429),w=function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}};var S=function(){var e=Object(o.j)(),t="dark"!==e.mode&&e.mode?"light":"dark",n=function(){var e=Object(r.useState)(w()),t=Object(s.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){function e(){a(w())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}().height,i=a.a.useMemo((function(){return Object(x.a)({palette:{mode:t}})}),[t]);return Object(b.jsx)("div",{className:"App",style:{backgroundColor:"transparent"},children:Object(b.jsxs)(y.a,{theme:i,children:[Object(b.jsx)(O.a,{}),Object(b.jsx)(g,{}),Object(b.jsx)(k.a,{sx:{width:600,flexGrow:1,mt:"".concat(Math.floor(.2*n),"px"),px:"50%",display:"flex",alignSelf:"center",justifyContent:"center",alignContent:"center"},children:Object(b.jsx)(j.b,{})})]})})},A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,782)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))};n(725);c.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(o.d,{children:Object(b.jsx)(o.g,{children:Object(b.jsx)(o.a,{children:Object(b.jsx)(o.b,{children:Object(b.jsx)(S,{})})})})})}),document.getElementById("root")),A()},8:function(e,t,n){"use strict";n.d(t,"h",(function(){return r.i})),n.d(t,"a",(function(){return r.c})),n.d(t,"c",(function(){return r.f})),n.d(t,"b",(function(){return r.d})),n.d(t,"f",(function(){return a.a})),n.d(t,"e",(function(){return i.b})),n.d(t,"g",(function(){return i.c})),n.d(t,"d",(function(){return l.a}));n(211);var r=n(49),a=(n(50),n(397),n(209)),i=n(82);var c=n(5),o=n(55),s=n(52),u=n.n(s);o.BinaryReader.prototype.readPubkey=function(){var e=this.readFixedArray(32);return new c.d(e)},o.BinaryWriter.prototype.writePubkey=function(e){this.writeFixedArray(e.toBuffer())},o.BinaryReader.prototype.readPubkeyAsString=function(){var e=this.readFixedArray(32);return u.a.encode(e)},o.BinaryWriter.prototype.writePubkeyAsString=function(e){this.writeFixedArray(u.a.decode(e))};var l=n(398)},82:function(e,t,n){"use strict";n.d(t,"e",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return h})),n.d(t,"d",(function(){return m}));n(26);var r=n(2),a=n.n(r),i=n(7),c=n(14),o=n(0),s=n(5),u=n(44),l=n.n(u),d=new l.a(10);d.pow(new l.a(18)),d.pow(new l.a(18)),d.pow(new l.a(27)),new l.a(0),new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:8});function f(e,t){var n=Object(o.useState)((function(){var n=localStorage.getItem(e);return n?JSON.parse(n):t})),r=Object(c.a)(n,2),a=r[0],i=r[1],s=Object(o.useCallback)((function(t){if(a!==t)if(i(t),null===t)localStorage.removeItem(e);else try{localStorage.setItem(e,JSON.stringify(t))}catch(n){}}),[a,e]);return[a,s]}var p=function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r,i,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="pda-"+t.reduce((function(e,t){return e+t.toString("hex")}),"")+n.toString(),!(i=localStorage.getItem(r))){e.next=5;break}return c=JSON.parse(i),e.abrupt("return",[c.key,parseInt(c.nonce)]);case 5:return e.next=7,s.d.findProgramAddress(t,n);case 7:o=e.sent;try{localStorage.setItem(r,JSON.stringify({key:o[0].toBase58(),nonce:o[1]}))}catch(a){}return e.abrupt("return",[o[0].toBase58(),o[1]]);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return"".concat(e.slice(0,t),"...").concat(e.slice(-t))}new Set(["USDC","wUSDC","USDT"]);function h(e,t){return Array.apply(0,new Array(Math.ceil(e.length/t))).map((function(n,r){return e.slice(r*t,(r+1)*t)}))}new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2});function m(e){return new Promise((function(t){return setTimeout(t,e)}))}},99:function(e,t,n){"use strict";n.r(t),n.d(t,"ENDPOINTS",(function(){return g})),n.d(t,"ConnectionProvider",(function(){return y})),n.d(t,"useConnection",(function(){return O})),n.d(t,"useConnectionConfig",(function(){return k})),n.d(t,"getErrorForTransaction",(function(){return S})),n.d(t,"SequenceType",(function(){return w})),n.d(t,"sendTransactionsWithManualRetry",(function(){return A})),n.d(t,"sendTransactions",(function(){return C})),n.d(t,"sendTransaction",(function(){return E})),n.d(t,"sendTransactionWithRetry",(function(){return T})),n.d(t,"getUnixTs",(function(){return M})),n.d(t,"sendSignedTransaction",(function(){return P}));var r=n(26),a=n(2),i=n.n(a),c=n(7),o=n(25),s=n(14),u=n(82),l=n(5),d=n(0),f=n.n(d),p=n(209),b=n(210),h=n(94),m=n(15),v=n(4),g=[{name:"mainnet-beta",endpoint:"https://api.mainnet-beta.solana.com",ChainId:h.a.MainnetBeta},{name:"devnet",endpoint:"https://api.devnet.solana.com",ChainId:h.a.Devnet}],j=g[0].endpoint,x=f.a.createContext({endpoint:j,setEndpoint:function(){},connection:new l.a(j,"recent"),env:g[0].name,tokens:[],tokenMap:new Map});function y(e){var t,n=e.children,r=void 0===n?void 0:n,a=Object(u.e)("connectionEndpoint",g[0].endpoint),i=Object(s.a)(a,2),c=i[0],f=i[1],p=Object(d.useMemo)((function(){return new l.a(c,"recent")}),[c]),b=(null===(t=g.find((function(e){return e.endpoint===c})))||void 0===t?void 0:t.name)||g[0].name,m=Object(d.useState)([]),j=Object(s.a)(m,2),y=j[0],O=j[1],k=Object(d.useState)(new Map),w=Object(s.a)(k,2),S=w[0],A=w[1];return Object(d.useEffect)((function(){(new h.b).resolve().then((function(e){var t,n=e.excludeByTag("nft").filterByChainId((null===(t=g.find((function(e){return e.endpoint===c})))||void 0===t?void 0:t.ChainId)||h.a.MainnetBeta).getList(),r=Object(o.a)(n).reduce((function(e,t){return e.set(t.address,t),e}),new Map);A(r),O(n)}))}),[b,c]),Object(d.useEffect)((function(){var e=p.onAccountChange(l.b.generate().publicKey,(function(){}));return function(){p.removeAccountChangeListener(e)}}),[p]),Object(d.useEffect)((function(){var e=p.onSlotChange((function(){return null}));return function(){p.removeSlotChangeListener(e)}}),[p]),Object(v.jsx)(x.Provider,{value:{endpoint:c,setEndpoint:f,connection:p,tokens:y,tokenMap:S,env:b},children:r})}function O(){return Object(d.useContext)(x).connection}function k(){var e=Object(d.useContext)(x);return{endpoint:e.endpoint,setEndpoint:e.setEndpoint,env:e.env,tokens:e.tokens,tokenMap:e.tokenMap}}var w,S=function(){var e=Object(c.a)(i.a.mark((function e(t,n){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.confirmTransaction(n,"max");case 2:return e.next=4,t.getParsedConfirmedTransaction(n);case 4:return r=e.sent,a=[],(null===r||void 0===r?void 0:r.meta)&&r.meta.logMessages&&r.meta.logMessages.forEach((function(e){for(var t,n=/Error: (.*)/gm;null!==(t=n.exec(e));)t.index===n.lastIndex&&n.lastIndex++,t.length>1&&a.push(t[1])})),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function A(e,t,n,r){return B.apply(this,arguments)}function B(){return(B=Object(c.a)(i.a.mark((function e(t,n,r,a){var c,o,s,u,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=0,o=0,s=null,u={},r=r.filter((function(e,t){return e.length>0||(u[t]=!0,!1)})),l=a.filter((function(e,t){return!u[t]}));case 6:if(!(c<r.length&&o<3)){e.next=29;break}if(r=r.slice(c,r.length),l=l.slice(c,l.length),r.length===s?o+=1:o=0,e.prev=10,1!==r.length){e.next=17;break}return e.next=14,T(t,n,r[0],l[0],"single");case 14:c=1,e.next=20;break;case 17:return e.next=19,C(t,n,r,l,w.StopOnFailure,"single");case 19:c=e.sent;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(10),console.error(e.t0);case 25:console.log("Died on ",c,"retrying from instruction",r[c],"instructions length is",r.length),s=r.length,e.next=6;break;case 29:case"end":return e.stop()}}),e,null,[[10,22]])})))).apply(this,arguments)}!function(e){e[e.Sequential=0]="Sequential",e[e.Parallel=1]="Parallel",e[e.StopOnFailure=2]="StopOnFailure"}(w||(w={}));var C=function(){var e=Object(c.a)(i.a.mark((function e(t,n,r,a){var c,s,u,d,f,p,b,h,v,g,j,x,y,O,k=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=k.length>4&&void 0!==k[4]?k[4]:w.Parallel,s=k.length>5&&void 0!==k[5]?k[5]:"singleGossip",u=k.length>6&&void 0!==k[6]?k[6]:function(e,t){},d=k.length>7&&void 0!==k[7]?k[7]:function(e,t){return!1},f=k.length>8?k[8]:void 0,n.publicKey){e.next=7;break}throw new m.i;case 7:if(p=[],f){e.next=12;break}return e.next=11,t.getRecentBlockhash(s);case 11:f=e.sent;case 12:b=function(e){var t=r[e],i=a[e];if(0===t.length)return"continue";var c=new l.g;t.forEach((function(e){return c.add(e)})),c.recentBlockhash=f.blockhash,c.setSigners.apply(c,[n.publicKey].concat(Object(o.a)(i.map((function(e){return e.publicKey}))))),i.length>0&&c.partialSign.apply(c,Object(o.a)(i)),p.push(c)},h=0;case 14:if(!(h<r.length)){e.next=21;break}if("continue"!==b(h)){e.next=18;break}return e.abrupt("continue",18);case 18:h++,e.next=14;break;case 21:return e.next=23,n.signAllTransactions(p);case 23:v=e.sent,g=[],j={breakEarly:!1,i:0},console.log("Signed txns length",v.length,"vs handed in length",r.length),x=i.a.mark((function e(n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=P({connection:t,signedTransaction:v[n]})).then((function(e){var t=e.txid;e.slot;u(t,n)})).catch((function(e){d(v[n],n),c===w.StopOnFailure&&(j.breakEarly=!0,j.i=n)})),c===w.Parallel){e.next=16;break}return e.prev=3,e.next=6,r;case 6:e.next=14;break;case 8:if(e.prev=8,e.t0=e.catch(3),console.log("Caught failure",e.t0),!j.breakEarly){e.next=14;break}return console.log("Died on ",j.i),e.abrupt("return",{v:j.i});case 14:e.next=17;break;case 16:g.push(r);case 17:case"end":return e.stop()}}),e,null,[[3,8]])})),y=0;case 29:if(!(y<v.length)){e.next=37;break}return e.delegateYield(x(y),"t0",31);case 31:if("object"!==typeof(O=e.t0)){e.next=34;break}return e.abrupt("return",O.v);case 34:y++,e.next=29;break;case 37:if(c===w.Parallel){e.next=40;break}return e.next=40,Promise.all(g);case 40:return e.abrupt("return",v.length);case 41:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),E=function(){var e=Object(c.a)(i.a.mark((function e(t,n,r,a){var c,s,u,d,f,h,g,j,x,y,O,k,w,A,B=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=!(B.length>4&&void 0!==B[4])||B[4],s=B.length>5&&void 0!==B[5]?B[5]:"singleGossip",u=B.length>6&&void 0!==B[6]&&B[6],d=B.length>7?B[7]:void 0,n.publicKey){e.next=6;break}throw new m.i;case 6:if(f=new l.g,r.forEach((function(e){return f.add(e)})),e.t0=d,e.t0){e.next=13;break}return e.next=12,t.getRecentBlockhash(s);case 12:e.t0=e.sent;case 13:if(f.recentBlockhash=e.t0.blockhash,u?(h=f).setSigners.apply(h,Object(o.a)(a.map((function(e){return e.publicKey})))):(g=f).setSigners.apply(g,[n.publicKey].concat(Object(o.a)(a.map((function(e){return e.publicKey}))))),a.length>0&&(j=f).partialSign.apply(j,Object(o.a)(a)),u){e.next=20;break}return e.next=19,n.signTransaction(f);case 19:f=e.sent;case 20:return x=f.serialize(),y={skipPreflight:!0,commitment:s},e.next=24,t.sendRawTransaction(x,y);case 24:if(O=e.sent,k=0,!c){e.next=39;break}return e.next=29,K(O,z,t,s);case 29:if(w=e.sent){e.next=32;break}throw new Error("Timed out awaiting confirmation on transaction");case 32:if(k=(null===w||void 0===w?void 0:w.slot)||0,!(null===w||void 0===w?void 0:w.err)){e.next=39;break}return e.next=36,S(t,O);case 36:throw A=e.sent,Object(p.a)({message:"Transaction failed...",description:Object(v.jsxs)(v.Fragment,{children:[A.map((function(e){return Object(v.jsx)("div",{children:e})})),Object(v.jsx)(b.a,{address:O,type:"transaction"})]}),type:"error"}),new Error("Raw transaction ".concat(O," failed"));case 39:return e.abrupt("return",{txid:O,slot:k});case 40:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),T=function(){var e=Object(c.a)(i.a.mark((function e(t,n,r,a){var c,s,u,d,f,p,b,h,v,g,j,x=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=x.length>4&&void 0!==x[4]?x[4]:"singleGossip",s=x.length>5&&void 0!==x[5]&&x[5],u=x.length>6?x[6]:void 0,d=x.length>7?x[7]:void 0,n.publicKey){e.next=6;break}throw new m.i;case 6:if(f=new l.g,r.forEach((function(e){return f.add(e)})),e.t0=u,e.t0){e.next=13;break}return e.next=12,t.getRecentBlockhash(c);case 12:e.t0=e.sent;case 13:if(f.recentBlockhash=e.t0.blockhash,s?(p=f).setSigners.apply(p,Object(o.a)(a.map((function(e){return e.publicKey})))):(b=f).setSigners.apply(b,[n.publicKey].concat(Object(o.a)(a.map((function(e){return e.publicKey}))))),a.length>0&&(h=f).partialSign.apply(h,Object(o.a)(a)),s){e.next=26;break}return e.prev=17,e.next=20,n.signTransaction(f);case 20:f=e.sent,e.next=26;break;case 23:return e.prev=23,e.t1=e.catch(17),e.abrupt("return",!1);case 26:return d&&d(),console.log("About to send"),e.prev=28,e.next=31,P({connection:t,signedTransaction:f});case 31:return v=e.sent,g=v.txid,j=v.slot,e.abrupt("return",{txid:g,slot:j});case 37:e.prev=37,e.t2=e.catch(28),console.error(e.t2);case 40:case"end":return e.stop()}}),e,null,[[17,23],[28,37]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),M=function(){return(new Date).getTime()/1e3},z=15e3;function P(e){return I.apply(this,arguments)}function I(){return(I=Object(c.a)(i.a.mark((function e(t){var n,r,a,o,s,l,d,f,p,b,h,m,v;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.signedTransaction,r=t.connection,a=t.timeout,o=void 0===a?z:a,s=n.serialize(),l=M(),d=0,e.next=6,r.sendRawTransaction(s,{skipPreflight:!0});case 6:return f=e.sent,console.log("Started awaiting confirmation for",f),p=!1,Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p||!(M()-l<o)){e.next=6;break}return r.sendRawTransaction(s,{skipPreflight:!0}),e.next=4,Object(u.d)(500);case 4:e.next=0;break;case 6:case"end":return e.stop()}}),e)})))(),e.prev=10,e.next=13,K(f,o,r,"recent",!0);case 13:if(b=e.sent){e.next=16;break}throw new Error("Timed out awaiting confirmation on transaction");case 16:if(!b.err){e.next=19;break}throw console.error(b.err),new Error("Transaction failed: Custom instruction error");case 19:d=(null===b||void 0===b?void 0:b.slot)||0,e.next=47;break;case 22:if(e.prev=22,e.t0=e.catch(10),console.error("Timeout Error caught",e.t0),!e.t0.timeout){e.next=27;break}throw new Error("Timed out awaiting confirmation on transaction");case 27:return h=null,e.prev=28,e.next=31,F(r,n,"single");case 31:h=e.sent.value,e.next=36;break;case 34:e.prev=34,e.t1=e.catch(28);case 36:if(!h||!h.err){e.next=47;break}if(!h.logs){e.next=46;break}m=h.logs.length-1;case 39:if(!(m>=0)){e.next=46;break}if(!(v=h.logs[m]).startsWith("Program log: ")){e.next=43;break}throw new Error("Transaction failed: "+v.slice("Program log: ".length));case 43:--m,e.next=39;break;case 46:throw new Error(JSON.stringify(h.err));case 47:return e.prev=47,p=!0,e.finish(47);case 50:return console.log("Latency",f,M()-l),e.abrupt("return",{txid:f,slot:d});case 52:case"end":return e.stop()}}),e,null,[[10,22,47,50],[28,34]])})))).apply(this,arguments)}function F(e,t,n){return W.apply(this,arguments)}function W(){return(W=Object(c.a)(i.a.mark((function e(t,n,r){var a,c,o,s,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._recentBlockhash(t._disableBlockhashCaching);case 2:return n.recentBlockhash=e.sent,a=n.serializeMessage(),c=n._serialize(a),o=c.toString("base64"),s=[o,{encoding:"base64",commitment:r}],e.next=10,t._rpcRequest("simulateTransaction",s);case 10:if(!(u=e.sent).error){e.next=13;break}throw new Error("failed to simulate transaction: "+u.error.message);case 13:return e.abrupt("return",u.result);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,t,n){return L.apply(this,arguments)}function L(){return L=Object(c.a)(i.a.mark((function e(t,n,a){var o,s,l,d,f,p,b,h,m,v,j=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=j.length>3&&void 0!==j[3]?j[3]:"recent",s=j.length>4&&void 0!==j[4]&&j[4],l=a._rpcEndpoint,d="mainnet-beta",f=Object(r.a)(g),e.prev=5,f.s();case 7:if((p=f.n()).done){e.next=14;break}if((b=p.value).endpoint!==l){e.next=12;break}return d=b.name,e.abrupt("break",14);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),f.e(e.t0);case 19:return e.prev=19,f.f(),e.finish(19);case 22:return h=!1,m={slot:0,confirmations:0,err:null},v=0,e.next=27,new Promise(function(){var e=Object(c.a)(i.a.mark((function e(r,l){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout((function(){h||(h=!0,console.log("Rejecting for timeout..."),l({timeout:!0}))}),n);try{v=a.onSignature(t,(function(e,t){h=!0,m={err:e.err,slot:t.slot,confirmations:0},e.err?(console.log("Rejected via websocket",e.err),l(m)):(console.log("Resolved via websocket",e),r(m))}),o)}catch(f){h=!0,console.error("WS error in setup",t,f)}case 2:if(h||!s){e.next=8;break}return Object(c.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.getSignatureStatuses([t]);case 3:n=e.sent,m=n&&n.value[0],console.log("https://explorer.solana.com/tx/".concat(t,"?cluster=").concat(d)),h||(m?m.err?(console.log("REST error for",t,m),h=!0,l(m.err)):m.confirmations?(console.log("REST confirmation for",t,m),h=!0,r(m)):console.log("REST no confirmations for",t,m):console.log("REST null result for",t,m)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),h||console.log("REST connection error: txid",t,e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))(),e.next=6,Object(u.d)(2e3);case 6:e.next=2;break;case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 27:return m=e.sent,a._signatureSubscriptions[v]&&a.removeSignatureListener(v),h=!0,console.log("Returning status",m),e.abrupt("return",m);case 32:case"end":return e.stop()}}),e,null,[[5,16,19,22]])}))),L.apply(this,arguments)}}},[[726,1,2]]]);
//# sourceMappingURL=main.24e6185b.chunk.js.map